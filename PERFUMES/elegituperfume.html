<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Arma tu perfume ideal</title>
<style>
  body {
    margin: 0; padding: 0; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: radial-gradient(circle at center, #1a1a1a, #000);
    color: #fff;
    display: flex; flex-direction: column; align-items: center; min-height: 100vh;
  }
  h1 {
    margin: 20px 0 10px 0; font-weight: 700;
  }
  #notes-container {
    display: flex; gap: 12px; flex-wrap: wrap; justify-content: center;
    margin-bottom: 20px; padding: 0 10px;
  }
  .note {
    background: #444;
    border-radius: 40px;
    padding: 10px 18px;
    cursor: pointer;
    user-select: none;
    transition: background 0.3s, box-shadow 0.3s;
    font-weight: 600;
    min-width: 90px;
    text-align: center;
    box-shadow: 0 0 8px rgba(255 255 255 / 0.1);
    display: flex;
    align-items: center;
    gap: 6px;
    justify-content: center;
  }
  .note img {
    width: 20px;
    height: 20px;
  }
  .note:hover:not(.selected) {
    background: #ff4d4d;
    box-shadow: 0 0 12px #ff4d4d;
  }
  .note.selected {
    background: #ff4d4d;
    box-shadow: 0 0 20px #ff4d4d;
    cursor: default;
  }
  #fragrance-bottle {
    position: relative;
    width: 180px;
    height: 300px;
    border: 3px solid #ff4d4d;
    border-radius: 30px 30px 50px 50px;
    background: linear-gradient(to bottom, #fce1e1 0%, #f08a8a 100%);
    overflow: hidden;
    display: flex;
    align-items: flex-end;
    justify-content: center;
    cursor: not-allowed;
    transition: all 0.3s;
  }
  #fragrance-bottle.enabled {
    cursor: pointer;
    box-shadow: 0 0 20px #ff4d4d;
  }
  #bottle-fill {
    position: absolute;
    bottom: 0;
    width: 100%;
    height: 0;
    background: linear-gradient(to top, #ff4d4d, #f08080);
    border-radius: 0 0 50px 50px;
    transition: height 0.4s ease;
  }
  #bottle-content {
    position: relative;
    z-index: 2;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    text-align: center;
    height: 100%;
    width: 100%;
    padding: 10px;
    opacity: 0;
    transition: opacity 0.4s;
  }
  #bottle-content.show {
    opacity: 1;
  }
  #bottle-content img {
    width: 100px;
    height: 100px;
    object-fit: contain;
    margin-bottom: 10px;
  }
  #btn-reset {
    margin-top: 20px;
    padding: 10px 25px;
    border: none;
    background: #ff4d4d;
    color: white;
    font-weight: 700;
    font-size: 16px;
    border-radius: 30px;
    cursor: pointer;
    box-shadow: 0 0 10px #ff4d4d;
    display: none;
    user-select: none;
  }
  #btn-reset:hover {
    background: #e04343;
  }
</style>
</head>
<body>
<h1>Arma tu perfume ideal</h1>
<div id="notes-container" aria-label="Selecciona notas para tu perfume"></div>
<div id="fragrance-bottle" role="button" aria-disabled="true" tabindex="0" aria-label="Frasco de perfume, haz clic cuando selecciones 4 notas">
  <div id="bottle-fill" aria-hidden="true"></div>
  <div id="bottle-content" aria-live="polite" aria-atomic="true">
    <img id="perfume-img" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==" alt="" />
    <p id="perfume-name" aria-live="polite" aria-atomic="true"></p>
  </div>
</div>
<button id="btn-reset" type="button">Jugar otra vez</button>

<script>
  'use strict';

  const notas = ["Vainilla","Jazmín","Ámbar","Cítricos","Cuero","Sándalo","Bergamota","Almizcle","Lavanda","Rosa","Menta","Canela","Patchouli","Flor de Azahar","Coco"];
  const iconosNotas = {
    "Vainilla":"https://raw.githubusercontent.com/CarlosDimare/PERFUMES/main/vainilla.jpg",
    "Jazmín":"https://raw.githubusercontent.com/CarlosDimare/PERFUMES/main/jazmin.jpeg",
    "Ámbar":"https://raw.githubusercontent.com/CarlosDimare/PERFUMES/main/ambar.jpg",
    "Cítricos":"https://raw.githubusercontent.com/CarlosDimare/PERFUMES/main/citrico.jpeg",
    "Cuero":"https://raw.githubusercontent.com/CarlosDimare/PERFUMES/main/cuero.jpeg",
    "Sándalo":"https://raw.githubusercontent.com/CarlosDimare/PERFUMES/main/sandalo.jpeg",
    "Bergamota":"https://raw.githubusercontent.com/CarlosDimare/PERFUMES/main/bergamota.jpeg",
    "Almizcle":"https://raw.githubusercontent.com/CarlosDimare/PERFUMES/main/almizcle.jpeg",
    "Lavanda":"https://raw.githubusercontent.com/CarlosDimare/PERFUMES/main/lavanda.jpeg",
    "Rosa":"https://raw.githubusercontent.com/CarlosDimare/PERFUMES/main/rosa.jpeg",
    "Menta":"https://raw.githubusercontent.com/CarlosDimare/PERFUMES/main/menta.jpeg",
    "Canela":"https://raw.githubusercontent.com/CarlosDimare/PERFUMES/main/canela.jpeg",
    "Patchouli":"https://raw.githubusercontent.com/CarlosDimare/PERFUMES/main/patchouli.jpeg",
    "Flor de Azahar":"https://raw.githubusercontent.com/CarlosDimare/PERFUMES/main/azahar.jpeg",
    "Coco":"https://raw.githubusercontent.com/CarlosDimare/PERFUMES/main/coco.jpeg"
  };

  const perfumes = [
    {nombre:"La Vie Est Belle – Lancôme", notas:["Vainilla","Jazmín","Almizcle"]},
    {nombre:"Good Girl – Carolina Herrera", notas:["Jazmín","Ámbar","Sándalo"]},
    {nombre:"Bleu de Chanel", notas:["Cítricos","Sándalo","Almizcle"]},
    {nombre:"Dior Sauvage", notas:["Bergamota","Lavanda","Cítricos"]},
    {nombre:"Black Opium – YSL", notas:["Vainilla","Ámbar","Cítricos"]},
    {nombre:"J'Adore – Dior", notas:["Rosa","Jazmín","Ámbar"]},
    {nombre:"1 Million – Paco Rabanne", notas:["Ámbar","Cuero","Bergamota"]},
    {nombre:"Light Blue – D&G", notas:["Cítricos","Rosa","Bergamota"]},
    {nombre:"Libre – YSL", notas:["Lavanda","Jazmín","Ámbar"]},
    {nombre:"Coco Mademoiselle – Chanel", notas:["Rosa","Vainilla","Ámbar"]},
    {nombre:"Armani Code – Armani", notas:["Ámbar","Flor de Azahar","Sándalo"]},
    {nombre:"Flowerbomb – Viktor & Rolf", notas:["Jazmín","Rosa","Patchouli"]},
    {nombre:"Eros – Versace", notas:["Menta","Vainilla","Patchouli"]},
    {nombre:"L'Homme – Yves Saint Laurent", notas:["Bergamota","Menta","Sándalo"]},
    {nombre:"Acqua di Gio – Armani", notas:["Cítricos","Menta","Patchouli"]},
    {nombre:"Angel – Mugler", notas:["Patchouli","Canela","Vainilla"]},
    {nombre:"Hypnotic Poison – Dior", notas:["Vainilla","Almizcle","Coco"]},
    {nombre:"The One – Dolce & Gabbana", notas:["Cítricos","Sándalo","Almizcle"]},
    {nombre:"Allure – Chanel", notas:["Rosa","Vainilla","Sándalo"]},
    {nombre:"No.5 – Chanel", notas:["Jazmín","Rosa","Ámbar"]}
  ];

  const perfumeImgs = {
    "La Vie Est Belle – Lancôme": "https://raw.githubusercontent.com/CarlosDimare/PERFUMES/refs/heads/main/PERFUMES/LA%20VIE%20EST%20BELLE.jpeg",
    "Good Girl – Carolina Herrera": "https://raw.githubusercontent.com/CarlosDimare/PERFUMES/refs/heads/main/PERFUMES/GOOD%20GIRL.jpeg",
    "Bleu de Chanel": "https://raw.githubusercontent.com/CarlosDimare/PERFUMES/refs/heads/main/PERFUMES/BLUE.jpeg",
    "Dior Sauvage": "https://raw.githubusercontent.com/CarlosDimare/PERFUMES/refs/heads/main/PERFUMES/SAVAGE.jpeg",
    "Black Opium – YSL": "https://raw.githubusercontent.com/CarlosDimare/PERFUMES/refs/heads/main/PERFUMES/BLACK%20OPIUM.jpeg",
    "J'Adore – Dior": "https://raw.githubusercontent.com/CarlosDimare/PERFUMES/refs/heads/main/PERFUMES/JADORE.jpeg",
    "1 Million – Paco Rabanne": "https://raw.githubusercontent.com/CarlosDimare/PERFUMES/refs/heads/main/PERFUMES/1%20MILLION.jpeg",
    "Light Blue – D&G": "https://raw.githubusercontent.com/CarlosDimare/PERFUMES/refs/heads/main/PERFUMES/LIGHT%20BLUE.jpg",
    "Libre – YSL": "https://raw.githubusercontent.com/CarlosDimare/PERFUMES/refs/heads/main/PERFUMES/LIBRE.jpeg",
    "Coco Mademoiselle – Chanel": "https://raw.githubusercontent.com/CarlosDimare/PERFUMES/refs/heads/main/PERFUMES/COCO.jpeg",
    "Armani Code – Armani": "https://raw.githubusercontent.com/CarlosDimare/PERFUMES/refs/heads/main/PERFUMES/ARMANI%20CODE.jpeg",
    "Flowerbomb – Viktor & Rolf": "https://raw.githubusercontent.com/CarlosDimare/PERFUMES/refs/heads/main/PERFUMES/FLOWER%20BOMB.jpeg",
    "Eros – Versace": "https://raw.githubusercontent.com/CarlosDimare/PERFUMES/refs/heads/main/PERFUMES/EROS.jpeg",
    "L'Homme – Yves Saint Laurent": "https://raw.githubusercontent.com/CarlosDimare/PERFUMES/refs/heads/main/PERFUMES/LHOME.jpeg",
    "Acqua di Gio – Armani": "https://raw.githubusercontent.com/CarlosDimare/PERFUMES/refs/heads/main/PERFUMES/ACQUA.jpeg",
    "Angel – Mugler": "https://raw.githubusercontent.com/CarlosDimare/PERFUMES/refs/heads/main/PERFUMES/ANGEL.jpeg",
    "Hypnotic Poison – Dior": "https://raw.githubusercontent.com/CarlosDimare/PERFUMES/refs/heads/main/PERFUMES/HYPNOTIC.jpeg",
    "The One – Dolce & Gabbana": "https://raw.githubusercontent.com/CarlosDimare/PERFUMES/refs/heads/main/PERFUMES/THE%20ONE.jpeg",
    "Allure – Chanel": "https://raw.githubusercontent.com/CarlosDimare/PERFUMES/refs/heads/main/PERFUMES/ALLURE.jpeg",
    "No.5 – Chanel": "https://raw.githubusercontent.com/CarlosDimare/PERFUMES/refs/heads/main/PERFUMES/NO%205.jpeg"
  };

  let seleccionadas = [];

  const notesContainer = document.getElementById('notes-container');
  const bottle = document.getElementById('fragrance-bottle');
  const bottleFill = document.getElementById('bottle-fill');
  const bottleContent = document.getElementById('bottle-content');
  const perfumeImg = document.getElementById('perfume-img');
  const perfumeName = document.getElementById('perfume-name');
  const btnReset = document.getElementById('btn-reset');

  function crearNotas() {
    const fragment = document.createDocumentFragment();
    notas.forEach(nota => {
      const div = document.createElement('div');
      div.classList.add('note');
      div.setAttribute('role', 'button');
      div.setAttribute('tabindex', '0');
      div.setAttribute('aria-pressed', 'false');

      const icon = document.createElement('img');
      icon.src = iconosNotas[nota];
      icon.alt = `Icono de ${nota}`;
      icon.loading = 'lazy';

      const span = document.createElement('span');
      span.textContent = nota;

      div.appendChild(icon);
      div.appendChild(span);

      div.addEventListener('click', () => elegirNota(nota, div));
      div.addEventListener('keypress', (e) => {
        if (e.key === 'Enter' || e.key === ' ') {
          e.preventDefault();
          elegirNota(nota, div);
        }
      });

      fragment.appendChild(div);
    });
    notesContainer.appendChild(fragment);
  }

  function elegirNota(nota, elemento) {
    if (seleccionadas.includes(nota)) return;
    if (seleccionadas.length >= 4) return;
    seleccionadas.push(nota);
    elemento.classList.add('selected');
    elemento.setAttribute('aria-pressed', 'true');
    actualizarFrasco();
    if (seleccionadas.length === 4) {
      bottle.classList.add('enabled');
      bottle.setAttribute('aria-disabled', 'false');
      bottle.focus();
    }
  }

  function actualizarFrasco() {
    bottleFill.style.height = (seleccionadas.length / 4) * 100 + '%';
  }

  function mostrarPerfume() {
    if (!bottle.classList.contains('enabled')) return;
    if (seleccionadas.length < 4) return;

    let mejor = null, maxMatch = 0;
    perfumes.forEach(p => {
      const comunes = p.notas.filter(n => seleccionadas.includes(n)).length;
      if (comunes > maxMatch) {
        maxMatch = comunes;
        mejor = p;
      }
    });
    if (mejor) {
      perfumeName.textContent = mejor.nombre;
      // Corregido: Usar mejor.nombre directamente como clave en perfumeImgs
      perfumeImg.src = perfumeImgs[mejor.nombre] || "";
      perfumeImg.alt = `Imagen del perfume ${mejor.nombre}`;
      bottleContent.classList.add('show');
      btnReset.style.display = 'inline-block';
      bottle.classList.remove('enabled');
      bottle.setAttribute('aria-disabled', 'true');
    }
  }

  function resetear() {
    seleccionadas = [];
    bottleFill.style.height = "0%";
    bottleContent.classList.remove('show');
    perfumeImg.src = "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==";
    perfumeImg.alt = "";
    perfumeName.textContent = "";
    btnReset.style.display = "none";
    bottle.classList.remove('enabled');
    bottle.setAttribute('aria-disabled', 'true');
    document.querySelectorAll('.note.selected').forEach(n => {
      n.classList.remove('selected');
      n.setAttribute('aria-pressed', 'false');
    });
    bottle.focus();
  }

  bottle.addEventListener('click', mostrarPerfume);
  bottle.addEventListener('keydown', (e) => {
    if ((e.key === 'Enter' || e.key === ' ') && bottle.classList.contains('enabled')) {
      e.preventDefault();
      mostrarPerfume();
    }
  });
  btnReset.addEventListener('click', resetear);

  crearNotas();
</script>
</body>
</html>
